# 🌍CF-Domain-Autocheck

<details>
    <summary>修复日志</summary>
    🔲2025-08-29 <br>
    1.合并版本，鉴于新版本稳定了，删除老版的手动版本 <br>
    2.修复部署完后的配置导向界面提示信息 <br>
    3.删除pages部署逻辑，只支持workers部署，因为要用到cf的cron，workers比较方便 <br>
    <br>
    ☑️2025-08-29 <br>
    1.添加了whoisjson的api，支持一级域名自动查询信息并填写 <br>
    2.优化分类功能，单独设立分类管理功能 <br>
    3.增添统计功能，可以显示分类数量以及分类下的域名数量 <br>
    4.整合telegram多条信息为一条 <br>
    <br>
    ☑️2025-08-13 <br>
    1.修复到期日期会根据用户输入的注册时间和续期周期自动计算 <br>
    2.修复清除续期后，到期日期自动回调 <br>
    <br>
    ☑️2025-08-06 <br>
    1.修复手机端背景图会依页面内容自动放大或缩小 <br>
    2.新增可自定义手机端背景图
</details>

## 🚨本项目主要是和Ai沟通创作而成，小伙伴可自行进行完善或魔改🚨

* 项目是部署在Cloudflare平台的，作用只有监控域名的到期情况。
* 主要是针对那些白嫖的域名，例如`dpdns.org`之类的，可能有人注册了好几个，需要定期点击续期，或者有些白嫖的一年的域名，可以帮助进行到期监控，避免忘记到期时间。
* 主要功能：日期监控、价格记录、注册商记录、自定义标签、自定义续费链接、telegram提前通知。
> ⚠️ 想要vps监控功能的小伙伴请看这里：https://github.com/kamanfaiz/CF-Server-AutoCheck ⚠️

## 💻界面展示
|                                 登录界面                                  |                             监控界面                             |
|:-------------------------------------------------------------------------:|:----------------------------------------------------------------:|
| ![](https://imgr2.952536.xyz/Hexo/Article/PixPin_2025-07-26_23-05-27.png) | ![](https://imgr2.952536.xyz/Hexo/Article/20250829173210152.png) |

## 📌显示逻辑
### 一、卡头标签显示逻辑
| 判定条件         | 标签状态   |
|:-----------------|:-----------|
| 剩余天数小于1天  | ❌已过期    |
| 剩余天数为1-20天 | 📢即将过期 |
| 剩余天数大于20天 | ✅正常      |

### 二、卡片进度条显示逻辑
| 判定条件                  | 进度条状态 |
|:--------------------------|:-----------|
| 剩余天数小于周期的10%     | 🔴已过期   |
| 剩余天数是周期的10%-30%   | 🟡即将过期 |
| 剩余天数大于等于周期的30% | 🟢正常     |

## 🚀简易部署流程，若需要详细流程，请移步👉[Faiz博客](https://blog.faiz.hidns.co/2025/07/26/Domain-AutoCheck%E5%9F%9F%E5%90%8D%E5%88%B0%E6%9C%9F%E7%9B%91%E6%8E%A7/)
1. 创建workers，粘贴代码
> 1.0版本和2.0版本都行，2.0版本支持一级域名自动查询，且细化单独分类；1.0版本为纯手动，且分类是以注册商进行简单分类
2. 创建一个KV，名字可以随便取
3. 绑定KV，变量名称：`DOMAIN_MONITOR`，注意大写，怕填错就复制粘贴，KV命名空间就下拉菜单选择刚才创建的KV名
4. 绑定自定义域名
5. 设定环境变量，cloudflare环境变量名如下：

    > 先级都是：Cloudflare环境变量＞代码中的变量＞默认值🚨

    | 名称              | 示例                                                                           | 必填 | 备注                                     |
    |:------------------|:-------------------------------------------------------------------------------|:----:|:-----------------------------------------|
    | TOKEN             | 默认是domain                                                                   |  ✅️   | 登录密码，最好自定义，不填则默认是domain |
    | TG_TOKEN          | telegram找[@BotFather](https://t.me/BotFather)获取                             |  ❌️   | 可在界面后端配置                         |
    | TG_ID             | telegram找[@userinfobot](https://t.me/userinfobot)获取，或者群机器人也行       |  ❌️   | 可在界面后端配置                         |
    | SITE_NAME         | 默认为域名到期监控                                                             |  ❌️   | 不填，默认就是域名到期监控               |
    | LOGO_URL          | https://123abc.com/logo.svg                                                    |  ❌️   | 网站logo，有需要可自行设置               |
    | BACKGROUND_URL    | https://123abc.com/img.jpg                                                     |  ❌️   | 背景图，有需要的可以自己设置             |
    | WHOISJSON_API_KEY | 去[WHOISJSON](https://whoisjson.com/)平台免费注册获取API，每个月免费1000次查询 |  ❌️   | 仅支持一级域名的自动查询，部署2.0的可以获取 |

6. 按照上述变量名添加完telegram变量后，点击`设置`——点击`触发事件`——点击`添加`——选择`cron触发器`——选择`一周中的某一天`——自定义时间
    > 🚨这里面的时间不是北京时间，是UTC时间，与北京时间相差8小时，例如设置为00:00，那么会在北京时间08:00进行通知🚨

## ♻️代码更新方式
功能基本没有问题，一般不太会大更新功能方面的内容，只可能修复一些用户体验类的bug，这些都不影响整体功能的使用，只有强迫症患者才需要更新。如果代码更新了，只需要重新复制粘贴代码可，因为域名数据都是储存在KV里面的，只要不动KV空间，就不会出现数据丢失。
> 🚨如果是喜欢在代码中填写变量的小伙伴，记得重新复制代码前保存好自己设置的变量。
